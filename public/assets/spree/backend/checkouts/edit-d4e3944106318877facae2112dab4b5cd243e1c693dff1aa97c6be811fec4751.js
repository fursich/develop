$(document).ready(function(){window.customerTemplate=HandlebarsTemplates["orders/customer_details/autocomplete"],formatCustomerResult=function(e){return customerTemplate({customer:e,bill_address:e.bill_address,ship_address:e.ship_address})},$("#customer_search").length>0&&($("#customer_search").select2({placeholder:Spree.translations.choose_a_customer,ajax:{url:Spree.routes.users_api,params:{headers:{"X-Spree-Token":Spree.api_key}},datatype:"json",data:function(e){return{q:{m:"or",email_start:e,addresses_firstname_start:e,addresses_lastname_start:e}}},results:function(e){return{results:e.users,more:e.current_page<e.pages}}},dropdownCssClass:"customer_search",formatResult:formatCustomerResult,formatSelection:function(e){return Select2.util.escapeMarkup(e.email)}}),$("#customer_search").on("select2-selecting",function(e){var s=e.choice;$("#order_email").val(s.email),$("#user_id").val(s.id),$("#guest_checkout_true").prop("checked",!1),$("#guest_checkout_false").prop("checked",!0),$("#guest_checkout_false").prop("disabled",!1);var r=s.bill_address;r&&($("#order_bill_address_attributes_firstname").val(r.firstname),$("#order_bill_address_attributes_lastname").val(r.lastname),$("#order_bill_address_attributes_address1").val(r.address1),$("#order_bill_address_attributes_address2").val(r.address2),$("#order_bill_address_attributes_city").val(r.city),$("#order_bill_address_attributes_zipcode").val(r.zipcode),$("#order_bill_address_attributes_phone").val(r.phone),$("#order_bill_address_attributes_country_id").select2("val",r.country_id).promise().done(function(){update_state("b",function(){$("#order_bill_address_attributes_state_id").select2("val",r.state_id)})}))}));var e=$("input#order_use_billing"),s=function(){e.is(":checked")?$("#shipping").hide():$("#shipping").show()};e.click(function(){s()}),s(),$("#guest_checkout_true").change(function(){$("#customer_search").val(""),$("#user_id").val(""),$("#checkout_email").val("");var e=["firstname","lastname","company","address1","address2","city","zipcode","state_id","country_id","phone"];$.each(e,function(e,s){$("#order_bill_address_attributes"+s).val(""),$("#order_ship_address_attributes"+s).val("")})})});