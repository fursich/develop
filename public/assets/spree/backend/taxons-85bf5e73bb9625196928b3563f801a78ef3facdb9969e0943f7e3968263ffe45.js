(function(){$(function(){var e,t,r,n,o,a,s,u,i,c;return a=HandlebarsTemplates["products/sortable"],o=function(e){return e.map(a).join("")||"<h4>"+Spree.translations.no_results+"</h4>"},s=function(e){return e.prev().insertAfter(e),c(e)},r=function(e){return e.next().insertBefore(e),c(e)},e=function(e){return $(e.srcElement).focus()},n=function(e){return e.keyCode===$.ui.keyCode.UP?s($(e.currentTarget)):e.keyCode===$.ui.keyCode.DOWN?r($(e.currentTarget)):void 0},u=function(e,t){return Spree.ajax({url:Spree.routes.classifications_api,method:"PUT",data:{product_id:t.item.data("product-id"),taxon_id:$("#taxon_id").val(),position:t.item.index()}})},i=$("#taxon_products").sortable().on({sortstart:e,sortstop:e,sortupdate:u}).on({click:e,keydown:n},".sort_item"),c=_.debounce(function(e){return i.trigger("sortupdate",{item:e})},250),t=function(e){return Select2.util.escapeMarkup(e.pretty_name)},$("#taxon_id").select2({dropdownCssClass:"taxon_select_box",placeholder:Spree.translations.find_a_taxon,ajax:{url:Spree.routes.taxons_search,params:{headers:{"X-Spree-Token":Spree.api_key}},data:function(e,t){return{per_page:50,page:t,q:{name_cont:e}}},results:function(e){return{results:e.taxons,more:e.current_page<e.pages}}},formatResult:t,formatSelection:t}),$("#taxon_id").on("change",function(e){return Spree.ajax({url:Spree.routes.taxon_products_api,data:{id:e.val,simple:1},success:function(e){return i.html(o(e.products))}})})})}).call(this);