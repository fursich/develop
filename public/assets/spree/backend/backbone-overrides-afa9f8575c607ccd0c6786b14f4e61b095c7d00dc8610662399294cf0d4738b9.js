(function(){var t,n=[].indexOf||function(t){for(var n=0,e=this.length;n<e;n++)if(n in this&&this[n]===t)return n;return-1};Backbone.ajax=Spree.ajax,t=Backbone.sync,Backbone.sync=function(e,a,r){var o,i,c;return o=r.beforeSend,r.beforeSend=function(t){var n;if(n=$('meta[name="csrf-token"]').attr("content"),n&&t.setRequestHeader("X-CSRF-Token",n),o)return o.apply(this,arguments)},c=["update","create","patch"],(null!=a?a.paramRoot:void 0)&&!r.data&&n.call(c,e)>=0&&(r.contentType="application/json",i={},i[a.paramRoot]=a.toJSON(r),r.data=JSON.stringify(i)),t(e,a,r)}}).call(this);