$.fn.productAutocomplete=function(e){"use strict";function t(e){return Select2.util.escapeMarkup(e.name)}e=e||{};var r="undefined"==typeof e.multiple||e.multiple;this.select2({minimumInputLength:3,multiple:r,initSelection:function(e,t){$.get(Spree.routes.admin_product_search,{ids:e.val().split(","),token:Spree.api_key},function(e){t(r?e.products:e.products[0])})},ajax:{url:Spree.routes.admin_product_search,datatype:"json",params:{headers:{"X-Spree-Token":Spree.api_key}},data:function(e,t){return{q:{name_cont:e,variants_including_master_sku_start:e,m:"or"},token:Spree.api_key,page:t}},results:function(e){return{results:e.products?e.products:[],more:e.current_page*e.per_page<e.total_count}}},formatResult:t,formatSelection:t})},$(document).ready(function(){$(".product_picker").productAutocomplete()});